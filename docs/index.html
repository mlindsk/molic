<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multivariate Oulier Detection In Contingency Tables • molic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Multivariate Oulier Detection In Contingency Tables">
<meta property="og:description" content="The molic package is designed fo outlier detection in, possibly high-dimensional, categorical data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">molic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/dermatitis.html">Detecting Skin Diseases</a>
    </li>
    <li>
      <a href="articles/genetic_example.html">Outlier Detection in Genetic Data</a>
    </li>
    <li>
      <a href="articles/outlier_intro.html">The Outlier Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlindsk/molic/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="molic-multivariate-outlierdetection-in-contingency-tables" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#molic-multivariate-outlierdetection-in-contingency-tables" class="anchor"></a>molic: Multivariate OutLIerdetection In Contingency tables</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->

<div id="about-molic" class="section level2">
<h2 class="hasAnchor">
<a href="#about-molic" class="anchor"></a>About molic</h2>
<p>An <strong>R</strong> package to perform outlier detection in contingency tables (i.e. categorical data) using decomposable graphical models (DGMs); models for which the underlying association between all variables can be depicted by an undirected graph. <strong>molic</strong> also offers algorithms for fitting undirected decomposable graphs. Compute-intensive procedures are implemented using <a href="http://www.rcpp.org/">Rcpp</a>/C++ for better run-time performance.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the current stable release of the package by using the <code>devtools</code> package:</p>
<div class="sourceCode"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"mlindsk/molic"</span>, <span class="kw">build_vignettes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></div>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h2>
<p>See the following:</p>
<ul>
<li>
<a href="https://mlindsk.github.io/molic/articles/outlier_intro.html">The Outlier Model</a>: The “behind the scenes” of the model.</li>
<li>
<a href="https://mlindsk.github.io/molic/articles/dermatitis.html">Detecting Skin Diseases</a>: An example of using the outlier model to detect skin diseases.</li>
<li>
<a href="https://mlindsk.github.io/molic/articles/genetic_example.html">Outlier Detection in Genetic Data</a>: An example of how to conduct an outlier analysis in genetic data.</li>
</ul>
<p>The following examples are from the documentation of <code>fit_outlier</code>.</p>
<div class="sourceCode"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">molic</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ess</span>)   <span class="co"># For the fit_graph function</span></pre></div>
<p>Psoriasis patients</p>
<div class="sourceCode"><pre class="r"><span class="no">d</span> <span class="kw">&lt;-</span> <span class="no">derma</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">ES</span> <span class="kw">==</span> <span class="st">"psoriasis"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="no">ES</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>()</pre></div>
<p>Fitting the interaction graph</p>
<div class="sourceCode"><pre class="r"><span class="no">g</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ess/man/fit_graph.html">fit_graph</a></span>(<span class="no">d</span>, <span class="kw">trace</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="co"># see package ess for details</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">g</span>, <span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">15</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p>This plot shows how the variables are ‘associated’ in the psoriasis class; see <a href="https://github.com/mlindsk/ess">ess</a> for more information about <code>fit_graph</code>. The outlier model exploits this knowledge instead of assuming independence between all variables (which would clearly be a wrong assumption looking at the graph). The graph may look very different for other classes than psoriasis.</p>
</div>
<div id="example-1---testing-which-observations-within-the-psoriasis-class-are-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1---testing-which-observations-within-the-psoriasis-class-are-outliers" class="anchor"></a>Example 1 - Testing which observations within the psoriasis class are outliers</h2>
<div class="sourceCode"><pre class="r"><span class="no">m1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/fit_outlier.html">fit_outlier</a></span>(<span class="no">d</span>, <span class="no">g</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">m1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  -------------------------------- </span>
<span class="co">#&gt;   Simulations: 10000 </span>
<span class="co">#&gt;   Variables: 34 </span>
<span class="co">#&gt;   Observations: 111 </span>
<span class="co">#&gt;   Estimated mean: 42.58 </span>
<span class="co">#&gt;   Estimated variance: 34.51 </span>
<span class="co">#&gt;  --------------------------------</span>
<span class="co">#&gt;   Critical value: 53.24268 </span>
<span class="co">#&gt;   Alpha: 0.05 </span>
<span class="co">#&gt;   &lt;outlier, outlier_model, list&gt; </span>
<span class="co">#&gt;  --------------------------------</span>
<span class="no">outs</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="reference/outliers.html">outliers</a></span>(<span class="no">m1</span>, <span class="no">d</span>)
<span class="no">douts</span> <span class="kw">&lt;-</span> <span class="no">d</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">outs</span>), ]
<span class="no">douts</span>
<span class="co">#&gt; # A tibble: 8 x 34</span>
<span class="co">#&gt;   c1    c2    c3    c4    c5    c6    c7    c8    c9    c10   c11   h12   h13  </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 2     1     2     2     2     0     0     0     0     0     0     0     1    </span>
<span class="co">#&gt; 2 2     2     2     3     3     0     0     0     0     2     0     0     1    </span>
<span class="co">#&gt; 3 3     3     2     2     1     0     0     0     0     1     0     0     2    </span>
<span class="co">#&gt; 4 1     1     1     1     1     0     0     0     1     1     0     0     0    </span>
<span class="co">#&gt; 5 3     2     1     2     2     0     0     0     2     2     0     0     0    </span>
<span class="co">#&gt; 6 1     1     1     1     1     0     0     0     2     2     0     0     0    </span>
<span class="co">#&gt; 7 2     3     1     2     1     0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt; 8 3     2     3     0     0     0     0     0     3     0     0     0     0    </span>
<span class="co">#&gt; # … with 21 more variables: h14 &lt;chr&gt;, h15 &lt;chr&gt;, h16 &lt;chr&gt;, h17 &lt;chr&gt;,</span>
<span class="co">#&gt; #   h18 &lt;chr&gt;, h19 &lt;chr&gt;, h20 &lt;chr&gt;, h21 &lt;chr&gt;, h22 &lt;chr&gt;, h23 &lt;chr&gt;,</span>
<span class="co">#&gt; #   h24 &lt;chr&gt;, h25 &lt;chr&gt;, h26 &lt;chr&gt;, h27 &lt;chr&gt;, h28 &lt;chr&gt;, h29 &lt;chr&gt;,</span>
<span class="co">#&gt; #   h30 &lt;chr&gt;, h31 &lt;chr&gt;, h32 &lt;chr&gt;, h33 &lt;chr&gt;, age &lt;chr&gt;</span></pre></div>
<p>Notice that m1 is of class ‘outlier’. This means, that the procedure has tested which observations <em>within</em> the data are outliers. This method is most often just referred to as outlier detection. The following plot is the distribution of the test statistic. Think of a simple t-test, where the distribution of the test statistic is a t-distribution. In order to conclude on the hypothesis, one finds the critical value and verify if the test statistic is greater or less than this.</p>
<div class="sourceCode"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">m1</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>Retrieving the test statistic for the individual observations:</p>
<div class="sourceCode"><pre class="r"><span class="no">x1</span> <span class="kw">&lt;-</span> <span class="no">douts</span>[<span class="fl">1</span>, ] <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>()
<span class="no">x2</span> <span class="kw">&lt;-</span> <span class="no">d</span>[<span class="fl">1</span>, ] <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>()
<span class="no">dev1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/deviance.html">deviance</a></span>(<span class="no">m1</span>, <span class="no">x1</span>) <span class="co"># falls within the critical region in the plot (the red area)</span>
<span class="no">dev2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/deviance.html">deviance</a></span>(<span class="no">m1</span>, <span class="no">x2</span>) <span class="co"># falls within the acceptable region in the plot</span>
<span class="no">dev1</span>
<span class="co">#&gt; [1] 58.97452</span>
<span class="no">dev2</span>
<span class="co">#&gt; [1] 51.05233</span></pre></div>
<p>Retrieving the p-values:</p>
<div class="sourceCode"><pre class="r"><span class="fu"><a href="reference/pval.html">pval</a></span>(<span class="no">m1</span>, <span class="no">dev1</span>)
<span class="co">#&gt; [1] 0.0101</span>
<span class="fu"><a href="reference/pval.html">pval</a></span>(<span class="no">m1</span>, <span class="no">dev2</span>)
<span class="co">#&gt; [1] 0.0848</span></pre></div>
</div>
<div id="example-2---testing-if-a-new-observation-is-an-outlier" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2---testing-if-a-new-observation-is-an-outlier" class="anchor"></a>Example 2 - Testing if a new observation is an outlier</h2>
<p>An observation from class “chronic dermatitis”:</p>
<div class="sourceCode"><pre class="r"><span class="no">z</span> <span class="kw">&lt;-</span> <span class="no">derma</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">ES</span> <span class="kw">==</span> <span class="st">"chronic dermatitis"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="no">ES</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>()</pre></div>
<p>Test if z is an outlier in class “psoriasis”:</p>
<div class="sourceCode"><pre class="r"><span class="no">m2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/fit_outlier.html">fit_outlier</a></span>(<span class="no">d</span>, <span class="no">g</span>, <span class="no">z</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">m2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  -------------------------------- </span>
<span class="co">#&gt;   Simulations: 10000 </span>
<span class="co">#&gt;   Variables: 34 </span>
<span class="co">#&gt;   Observations: 112 </span>
<span class="co">#&gt;   Estimated mean: 43.66 </span>
<span class="co">#&gt;   Estimated variance: 36.86 </span>
<span class="co">#&gt;  --------------------------------</span>
<span class="co">#&gt;   Critical value: 54.64489 </span>
<span class="co">#&gt;   Deviance: 77.92978 </span>
<span class="co">#&gt;   P-value: 0 </span>
<span class="co">#&gt;   Alpha: 0.05 </span>
<span class="co">#&gt;   &lt;novelty, outlier_model, list&gt; </span>
<span class="co">#&gt;  --------------------------------</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">m2</span>) <span class="co"># The vertical dotted line indicates the (deviance) test statistic of z</span></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>Notice that m2 is of class ‘novelty’. The term <em>novelty detection</em> is sometimes used in the litterature when the goal is to verify if a new unseen observation is an outlier in a homogeneous dataset. Retrieving the test statistic and p-value for <code>z</code></p>
<div class="sourceCode"><pre class="r"><span class="no">dz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/deviance.html">deviance</a></span>(<span class="no">m2</span>, <span class="no">z</span>)
<span class="fu"><a href="reference/pval.html">pval</a></span>(<span class="no">m2</span>, <span class="no">dz</span>)
<span class="co">#&gt; [1] 0</span></pre></div>
</div>
<div id="how-to-cite" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-cite" class="anchor"></a>How To Cite</h2>
<p>If you want to cite the <strong>outlier method</strong> please use</p>
<div class="sourceCode"><pre class="sourceCode latex"><code class="sourceCode latex">@article{lindskououtlier,
  title={Outlier Detection in Contingency Tables Using Decomposable Graphical Models},
  author={Lindskou, Mads and Svante Eriksen, Poul and Tvedebrink, Torben},
  journal={Scandinavian Journal of Statistics},
  publisher={Wiley Online Library},
  doi={10.1111/sjos.12407},
  year={2019}
}</code></pre></div>
<p>If you want to cite the <strong>molic</strong> package please use</p>
<div class="sourceCode"><pre class="sourceCode latex"><code class="sourceCode latex">@software{lindskoumolic,
  author       = {Mads Lindskou},
  title        = {{molic: An R package for multivariate outlier 
                   detection in contingency tables}},
  month        = oct,
  year         = 2019,
  publisher    = {Journal of Open Source Software},
  doi          = {10.21105/joss.01665},
  url          = {https://doi.org/10.21105/joss.01665}
}</code></pre></div>
<!-- Also, see the [jti](https://github.com/mlindsk/jti) package which is used for making inference in Bayesian networks or DGMs; in the latter case, one can exploit the **ess** package. -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mlindsk/molic/">https://​github.com/​mlindsk/​molic/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mlindsk/molic/issues">https://​github.com/​mlindsk/​molic/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mads Lindskou <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mlindsk/molic/actions"><img src="https://github.com/mlindsk/molic/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://joss.theoj.org/papers/9fa65ced7bf3db01343d68b4488196d8"><img src="https://joss.theoj.org/papers/9fa65ced7bf3db01343d68b4488196d8/status.svg" alt="status"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/177729633"><img src="https://zenodo.org/badge/177729633.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mads Lindskou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

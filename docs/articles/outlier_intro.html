<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Outlier Model • molic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Outlier Model">
<meta property="og:description" content="molic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">molic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dermatitis.html">Detecting Skin Diseases</a>
    </li>
    <li>
      <a href="../articles/genetic_example.html">Outlier Detection in Genetic Data</a>
    </li>
    <li>
      <a href="../articles/outlier_intro.html">The Outlier Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlindsk/molic/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Outlier Model</h1>
                        <h4 class="author">Mads Lindskou</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlindsk/molic/blob/master/vignettes/outlier_intro.Rmd"><code>vignettes/outlier_intro.Rmd</code></a></small>
      <div class="hidden name"><code>outlier_intro.Rmd</code></div>

    </div>

    
    
<div id="background-theory-on-the-outlier-detection-model" class="section level1">
<h1 class="hasAnchor">
<a href="#background-theory-on-the-outlier-detection-model" class="anchor"></a>Background Theory on The Outlier Detection Model</h1>
<p>This vignette is an introduction to the “behind-the-scenes” in the paper <span class="citation">Lindskou, Svante Eriksen, and Tvedebrink (2019)</span></p>
<div id="contingency-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#contingency-tables" class="anchor"></a>Contingency Tables</h3>
<p>The outlier detection model can only be used on discrete data; i.e data for which all variables can only take on a finite set of values (also called <em>levels</em>). We also say, that such variables are <em>discrete variables</em> or <em>categorical variables</em>.</p>
<!-- Examples of such variables are  -->
<!-- ```{r echo = FALSE} -->
<!-- Variables <- c("gender", -->
<!--   "seasons", -->
<!--   "DNA markers", -->
<!--   "grades", -->
<!--   "race", -->
<!--   "treatment" -->
<!-- ) -->
<!-- Levels  <- c("male/female", -->
<!--   "spring/summer/autumn/winther", -->
<!--   "A/T/C/G", -->
<!--   "pass/fail", -->
<!--   "white/hispanic/black", -->
<!--   "active/placebo" -->
<!-- ) -->
<!-- discrete_examples <- data.frame(Variables, Levels) -->
<!-- pander::pander(discrete_examples) -->
<!-- ``` -->
<p>Consider for example the built in discrete data set in <code>R</code> on <code>4526</code> applicants to graduate school at Berkeley for the six largest departments in 1973 classified by admission and sex. Below, a small sample of the data is seen.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="12%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="center">Admit</th>
<th align="center">Gender</th>
<th align="center">Dept</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Admitted</td>
<td align="center">Female</td>
<td align="center">C</td>
</tr>
<tr class="even">
<td align="center">Admitted</td>
<td align="center">Female</td>
<td align="center">C</td>
</tr>
<tr class="odd">
<td align="center">Rejected</td>
<td align="center">Female</td>
<td align="center">E</td>
</tr>
<tr class="even">
<td align="center">Admitted</td>
<td align="center">Male</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center">Admitted</td>
<td align="center">Male</td>
<td align="center">A</td>
</tr>
<tr class="even">
<td align="center">Rejected</td>
<td align="center">Female</td>
<td align="center">D</td>
</tr>
</tbody>
</table>
<p>Another and more appropriate way of showing the entire data, is via a <em>contingency table</em> which summarizes the counts of all combinations of <code>Admit</code>, <code>Gender</code> and <code>Dept</code></p>
<table class="table">
<colgroup>
<col width="15%">
<col width="12%">
<col width="9%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">Dept</td>
<td align="center">A</td>
<td align="center">B</td>
<td align="center">C</td>
<td align="center">D</td>
<td align="center">E</td>
<td align="center">F</td>
</tr>
<tr class="even">
<td>Admit</td>
<td>Gender</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>Admitted</td>
<td>Female</td>
<td align="center"></td>
<td align="center">89</td>
<td align="center">17</td>
<td align="center">202</td>
<td align="center">131</td>
<td align="center">94</td>
<td align="center">24</td>
</tr>
<tr class="even">
<td></td>
<td>Male</td>
<td align="center"></td>
<td align="center">512</td>
<td align="center">353</td>
<td align="center">120</td>
<td align="center">138</td>
<td align="center">53</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td>Rejected</td>
<td>Female</td>
<td align="center"></td>
<td align="center">19</td>
<td align="center">8</td>
<td align="center">391</td>
<td align="center">244</td>
<td align="center">299</td>
<td align="center">317</td>
</tr>
<tr class="even">
<td></td>
<td>Male</td>
<td align="center"></td>
<td align="center">313</td>
<td align="center">207</td>
<td align="center">205</td>
<td align="center">279</td>
<td align="center">138</td>
<td align="center">351</td>
</tr>
</tbody>
</table>
<p>This is much more informative and we can e.g. say immediately that <code>207</code> <code>Male</code> applicants were <code>Rejected</code> at department <code>B</code>. A particular entry in the table is called a <code>cell</code>. So <code>(Male, Rejected, B)</code> is a cell with <em>cellcount</em> <code>207</code>. The <em>dimension</em> of the table is the number of variables (here <code>3</code>). For high-dimensional tables things get more complicated and it may not be feasible to show the table (think of hundreds of DNA markers) and there may be many cells with zero cellcount.</p>
<p>The outlier detection method (described shortly) uses such contingency table data. However, it should be mentioned one more time, that a contingency table is in one-to-one correspondence with a “regular” categorical data set; contingency tables are nothing more than a convenient way of describing categorical data sets.</p>
</div>
<div id="outliers-and-novelties" class="section level3">
<h3 class="hasAnchor">
<a href="#outliers-and-novelties" class="anchor"></a>Outliers and Novelties</h3>
<p>An outlier can be regarded as an observation which deviates so much from the other observations in a database as to arouse suspicions that it was generated by a different mechanism. The outlier detection method directly adapts this definition by specifying a hypothesis of an outlier being distributed differently than all other observations in a given database. An outlier is also a very case-specific unit, since it may be interpreted as natural extreme noise in some applications and in other applications it might be the most interesting observation.</p>
<p>Outlier detection is usually divided into  (yes the same word) where the task is to detect observations that are extreme within some dataset. In combination to categorical data this amounts to detect unusual combinations between all variables in consideration. On the other hand, we might be interested in detecting if a new (novel) observation is an outlier in a homogeneous dataset which is sometimes referred to as  in the litterature. <strong>molic</strong> handles both of these cases through a single function called <code>fit_outlier</code>.</p>
<p>For high-dimensional data, it is a tedious task to determine anomalies such as outliers and novelties. The method described here is a multivariate method for outlier detection in high-dimensional contingency tables, i.e. data with discrete variables only.</p>
<p>The method relies on the class of decomposable graphical models to model the relationship among the variables of interest, which can be depicted by an undirected graph called the interaction graph. <strong>molic</strong> requires the <a href="https://github.com/mlindsk/ess">ess</a> package to be installed. The <strong>ess</strong> package offers the simple <code>fit_graph</code> function that conveniently fits a decomposable graph to data.</p>
</div>
<div id="decomposable-graphical-models" class="section level3">
<h3 class="hasAnchor">
<a href="#decomposable-graphical-models" class="anchor"></a>Decomposable Graphical Models</h3>
<p>In order to model the interaction structure between variables, we need to construct a <em>decomposable graphical model</em>. A graphical model is a statistical model for which an undirected graph represents the interaction between the vertices in the model. An undirected graph is a pair <span class="math inline">\(G = (V,E)\)</span> where <span class="math inline">\(V\)</span> is a set of vertices and <span class="math inline">\(E\)</span> is a set of edges connecting elements in <span class="math inline">\(V\)</span>. An edge connecting two vertices indicates that these two are dependend on each other; this is also called a two-way interaction. A threeway interaction occurs when three vertices are all mutually connected (e.g. can be visualized as a triangle). An undirected graph is <em>decomposable</em> if there are no cycles of length greater than four without a chord (an edge between two non-adjacent vertices in the cycle). The <em>subgraph</em> <span class="math inline">\(G_{A} = (A, E_{A})\)</span> consist of vertices <span class="math inline">\(A\subseteq V\)</span> from <span class="math inline">\(G\)</span> and the corresponding edges <span class="math inline">\(E_A\)</span> between them. A graph is <em>complete</em> if there is an edge between all pairs of vertices and a complete subgraph is called a (maximal) <em>clique</em> if it is not contained in any other complete subgraph. A subset of vertices is complete if it induces a complete subgraph. Two sets <span class="math inline">\(A,B \subseteq V\)</span> are separated by a third set <span class="math inline">\(C \subseteq V\)</span> if all paths between vertices in <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> go through <span class="math inline">\(C\)</span>. If <span class="math inline">\(C\)</span> is the smallest set such that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are separated, we say that <span class="math inline">\(C\)</span> is a (minimal) <em>separator</em> for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p><br>
Consider the undirected graph <span class="math inline">\(G\)</span> in the figure below.</p>
<br><div class="figure" style="text-align: center">
<img src="outlier_intro_files/figure-html/undirected_graph-1.png" alt="\label{fig:DG} $G$: An undirected decomposable graph." width="700"><p class="caption">
 <span class="math inline">\(G\)</span>: An undirected decomposable graph.
</p>
</div>
<p><br>
The set of vertices is <span class="math inline">\(V = \{a,b,c,d,e\}\)</span> and the set of edges is <span class="math inline">\(E = \{ab, bc, bd, cd,de\}\)</span>. The cliques are <span class="math inline">\(C_1 = \{a, b\}\)</span>, <span class="math inline">\(C_2 = \{b, c, d\}\)</span> and <span class="math inline">\(C_3 = \{d, e\}\)</span>. The minimal separators are <span class="math inline">\(S_{2} = \{b\}\)</span> and <span class="math inline">\(S_3 = \{d\}\)</span> where <span class="math inline">\(S_{2}\)</span> separates <span class="math inline">\(C_{1}\)</span> and <span class="math inline">\(C_{2}\)</span> and <span class="math inline">\(S_{3}\)</span> separates <span class="math inline">\(C_{2}\)</span> and <span class="math inline">\(C_{3}\)</span>. Since <span class="math inline">\(G\)</span> has no cycles of length greater than three, the graph is decomposable. Notice, that <span class="math inline">\(a\)</span> is only connected to <span class="math inline">\(\{c,d,e\}\)</span> through <span class="math inline">\(\{b\}\)</span>; we interpret this as “<span class="math inline">\(a\)</span> is independent of <span class="math inline">\(\{c,d,e\}\)</span> when we know the value of <span class="math inline">\(b\)</span>”. Such statements can be used to gain insight into complex structures.</p>
<p>Finally, we can associate a probability measure with an <em>interaction graph</em>; an undirected graph with each vertex being a random variable. For decomposable graphs, the probability density function can be written in terms of the cliques and separators. Collectively, models for which the interaction graph is decomposable are called decomposable graphical models (DGM). For more details on graphical models, see for example <span class="citation">(Whittaker 2009; Lauritzen 1996)</span>.</p>
<p>Tree graphs are per definition decomposable graphs. Notice that the graph <span class="math inline">\(G\)</span> is not a tree because of the presence of the cycle <span class="math inline">\(\{b,c,d\}\)</span>. However, the graph is indeed decomposable.</p>
</div>
</div>
<div id="the-test-statistic" class="section level1">
<h1 class="hasAnchor">
<a href="#the-test-statistic" class="anchor"></a>The Test Statistic</h1>
Assume that the <em>likelihood</em> <span class="math inline">\(L_0\)</span> expresses how likely it is that <span class="math inline">\(z_{new}\)</span> belongs to the database <span class="math inline">\(D\)</span>. We can also specify an alternative likelihood, <span class="math inline">\(L_{1}\)</span>, specifying how likely it is that <span class="math inline">\(z_{new}\)</span> do not belong to <span class="math inline">\(D\)</span>. We then define the <em>likelihood ratio</em> as
<span class="math display">\[\begin{equation*}
  \label{eq:LR}
  LR = \frac{L_{0}}{L_{1}},
\end{equation*}\]</span>
<p>which can be shown to be completely specified through the counts of observations in cliques and separators for the given interaction graph. We can therefore test if <span class="math inline">\(z_{new}\)</span> is an outlier in <span class="math inline">\(D\)</span> by calculating <span class="math inline">\(LR\)</span> and determine if the value of <span class="math inline">\(LR\)</span> is “too large” in which case we would reject that <span class="math inline">\(z_{new}\)</span> comes from <span class="math inline">\(D\)</span>.</p>
<div id="a-note-on-novelty-detection" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-on-novelty-detection" class="anchor"></a>A note on novelty detection</h3>
<p>It should be noted, that the likelihood ratio defined above, applies to novelty detection; i.e. we test if the novel observation <span class="math inline">\(z_{new}\)</span> is an outlier in <span class="math inline">\(D\)</span>. If the goal is to find the outliers in <span class="math inline">\(D\)</span> one should, one at a time, remove the observations from <span class="math inline">\(D\)</span> and regard the observations as novel observations and apply the above test statistic. All of this is taken care of in <strong>molic</strong> via the <code>fit_outlier</code> function.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-lauritzen1996graphical">
<p>Lauritzen, Steffen L. 1996. <em>Graphical Models</em>. Vol. 17. Clarendon Press.</p>
</div>
<div id="ref-lindskououtlier">
<p>Lindskou, Mads, Poul Svante Eriksen, and Torben Tvedebrink. 2019. “Outlier Detection in Contingency Tables Using Decomposable Graphical Models.” <em>Scandinavian Journal of Statistics</em>. Wiley Online Library. doi:<a href="https://doi.org/10.1111/sjos.12407">10.1111/sjos.12407</a>.</p>
</div>
<div id="ref-whittaker2009graphical">
<p>Whittaker, Joe. 2009. <em>Graphical Models in Applied Multivariate Statistics</em>. Wiley Publishing.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mads Lindskou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
